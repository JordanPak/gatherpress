(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var s in r)e.o(r,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{o_:()=>A});const t=window.wp.blocks,r=window.wp.i18n;(0,t.registerBlockVariation)("core/query-pagination-previous",{category:"gatherpress",keywords:[(0,r.__)("Page numbers"),(0,r.__)("Pagination")],isActive:["className"],attributes:{className:"gatherpress-query-pagination-previous",label:(0,r.__)("Previous Events","gatherpress")},name:"gatherpress-query-pagination-previous",title:(0,r.__)("Previous Events","gatherpress"),description:(0,r.__)("Displays the previous events link.","gatherpress")}),(0,t.registerBlockVariation)("core/query-pagination-next",{category:"gatherpress",keywords:[(0,r.__)("Page numbers"),(0,r.__)("Pagination")],isActive:["className"],attributes:{className:"gatherpress-query-pagination-next",label:(0,r.__)("Next Events","gatherpress")},name:"gatherpress-query-pagination-next",title:(0,r.__)("Next Events","gatherpress"),description:(0,r.__)("Displays the next events link.","gatherpress")});const s=window.wp.hooks,a=window.wp.blockEditor,n=window.wp.components,i=window.wp.element,o=window.ReactJSXRuntime,{Fill:l,Slot:u}=(0,n.createSlotFill)("GPQLControls"),p=({children:e})=>(0,o.jsx)(l,{children:e});p.Slot=({fillProps:e})=>(0,o.jsx)(u,{fillProps:e,children:e=>e.length?e:null});const c=p,{Fill:g,Slot:h}=(0,n.createSlotFill)("GPQLControlsInheritedQuery"),_=({children:e})=>(0,o.jsx)(g,{children:e});_.Slot=h;const d=_,y=({attributes:e,setAttributes:t})=>{const{query:{perPage:s,offset:a=0}={}}=e;return(0,o.jsx)(n.RangeControl,{label:(0,r.__)("Events Per Page","gatherpress"),min:1,max:50,onChange:r=>{t({query:{...e.query,perPage:r,offset:a}})},value:s})},m=window.wp.data,v=({attributes:e,setAttributes:t})=>{const{query:{exclude_current:s}={}}=e,a=(0,m.useSelect)((e=>e("core/editor").getCurrentPost()),[]);return a?(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(n.ToggleControl,{label:(0,r.__)("Exclude Current Event","gatherpress"),checked:!!s,onChange:r=>{t({query:{...e.query,exclude_current:r?a.id:0}})}})}):(0,o.jsx)("div",{children:(0,r.__)("Loading…","gatherpress")})},q=({attributes:e,setAttributes:t})=>{const{query:{gatherpress_events_query:s="upcoming"}={}}=e;return(0,m.useSelect)((e=>e("core/editor").getCurrentPost()),[])?(0,o.jsx)(n.ToggleControl,{label:(0,r.__)("Upcoming or past events.","gatherpress"),help:(0,r.sprintf)(/* translators: %s: 'upcoming' or 'past' */ /* translators: %s: 'upcoming' or 'past' */
(0,r._x)("Currently shows %s events.","'upcoming' or 'past'","gatherpress"),s),checked:"upcoming"===s,onChange:r=>{t({query:{...e.query,gatherpress_events_query:r?"upcoming":"past"}})}}):(0,o.jsx)("div",{children:(0,r.__)("Loading…","gatherpress")})},x=({attributes:e,setAttributes:t})=>{const{query:{offset:s=0}={}}=e;return(0,o.jsx)(n.RangeControl,{label:(0,r.__)("Event Offset","gatherpress"),min:0,max:50,value:s,onChange:r=>{t({query:{...e.query,offset:r}})}})},b=({attributes:e,setAttributes:t})=>{const{query:{order:s,orderBy:a}={}}=e,i="asc"===s?(0,r.__)("Ascending Order","gatherpress"):(0,r.__)("Descending Order","gatherpress");return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.SelectControl,{label:(0,r.__)("Order Events By","gatherpress"),value:a,help:"meta_value"===a||"meta_value_num"===a?(0,r.__)("Meta Value and Meta Value Num require that Meta Key is set in the Meta Query section.","gatherpress"):"",options:[{label:(0,r.__)("Event Date","gatherpress"),value:"datetime"},{label:(0,r.__)("Last Modified Date","gatherpress"),value:"modified"},{label:(0,r.__)("Title","gatherpress"),value:"title"},{label:(0,r.__)("Random","gatherpress"),value:"rand"},{label:(0,r.__)("Post ID","gatherpress"),value:"id"}],onChange:r=>{t({query:{...e.query,orderBy:r}})}}),(0,o.jsx)(n.ToggleControl,{label:i,checked:"asc"===s,onChange:()=>{t({query:{...e.query,order:"asc"===s?"desc":"asc"}})}})]})},f=({attributes:e,setAttributes:t})=>{const{query:{include_unfinished:s}={}}=e;return(0,o.jsx)(o.Fragment,{children:(0,o.jsx)(n.ToggleControl,{label:(0,r.__)("Include unfinished Events","gatherpress"),help:(0,r.sprintf)(/* translators: %s: 'upcoming' or 'past' */ /* translators: %s: 'upcoming' or 'past' */
(0,r._x)("%s events that have started but are not yet finished.","'Shows' or 'Hides'","gatherpress"),s?(0,r.__)("Shows","gatherpress"):(0,r.__)("Hides","gatherpress")),checked:s,onChange:r=>{t({query:{...e.query,include_unfinished:r?1:0}})}})})},w=window.moment;var j=e.n(w);window.wp.date;const P="YYYY-MM-DD HH:mm:ss",C=j().tz(E()).add(1,"day").set("hour",18).set("minute",0).set("second",0).format(P);function E(e=function(){if("object"==typeof GatherPress)return"eventDetails.dateTime.timezone".split(".").reduce(((e,t)=>e&&e[t]),GatherPress)}()){return j().tz.zone(e)?e:(0,r.__)("GMT","gatherpress")}j().tz(C,E()).add(2,"hours").format(P),(0,r.__)("1 hour","gatherpress"),(0,r.__)("1.5 hours","gatherpress"),(0,r.__)("2 hours","gatherpress"),(0,r.__)("3 hours","gatherpress"),(0,r.__)("Set an end time…","gatherpress");const k=e=>{const{attributes:{namespace:t}}=e;return t&&t===A},B=({attributes:e,setAttributes:t})=>{const{postType:r}=e.query;(0,i.useEffect)((()=>{if("gatherpress_event"===r){const r={...e,namespace:A,query:{...e.query,gatherpress_events_query:"upcoming",include_unfinished:1,order:"asc",orderBy:"datetime",inherit:!1}};t(r)}}),[r,e,t])};(0,s.addFilter)("editor.BlockEdit","core/query",(e=>t=>{if(!k(t)&&"core/query"!==t.name)return(0,o.jsx)(e,{...t});if(!k(t))return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(B,{...t}),(0,o.jsx)(e,{...t}),";"]});const s="gatherpress_event"===(0,m.select)("core/editor")?.getCurrentPostType(),{attributes:i}=t;return!1===i.query.inherit?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e,{...t}),(0,o.jsx)(a.InspectorControls,{children:(0,o.jsxs)(n.PanelBody,{title:(0,r.__)("Event Query Settings","gatherpress"),children:[(0,o.jsx)(q,{...t}),(0,o.jsx)(f,{...t}),s&&(0,o.jsx)(v,{...t}),(0,o.jsx)(y,{...t}),(0,o.jsx)(x,{...t}),(0,o.jsx)(b,{...t}),(0,o.jsx)(c.Slot,{fillProps:{...t}})]})})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e,{...t}),(0,o.jsx)(a.InspectorControls,{children:(0,o.jsxs)(n.PanelBody,{title:(0,r.__)("GatherPress Query Settings","gatherpress"),children:[(0,o.jsx)(b,{...t}),(0,o.jsx)(d.Slot,{fillProps:{...t}})]})})]})}));const D=[["core/paragraph",{placeholder:(0,r.__)("Add text or blocks that will display when a query returns no events.","gatherpress")}]],S=["core/query-no-results",{metadata:{name:(0,r.__)("No events","gatherpress")}},D],T=["core/query-pagination",{},[["core/query-pagination-previous",{label:(0,r.__)("Previous Events","gatherpress"),className:"gatherpress-query-pagination-previous"}],["core/query-pagination-numbers"],["core/query-pagination-next",{label:(0,r.__)("Next Events","gatherpress"),className:"gatherpress-query-pagination-next"}]]],A="gatherpress-event-query",F={namespace:A,query:{perPage:3,pages:0,offset:0,postType:"gatherpress_event",gatherpress_events_query:"upcoming",include_unfinished:1,order:"asc",orderBy:"datetime",inherit:!1}},M={category:"gatherpress",keywords:[(0,r.__)("Events","gatherpress"),(0,r.__)("Dates","gatherpress")],isActive:["namespace","query.postType"],attributes:{...F},allowedControls:["inherit","taxQuery"],scope:["block"]};(0,t.registerBlockVariation)("core/query",{...M,name:A,title:(0,r.__)("Event Query","gatherpress"),description:(0,r.__)("Create event queries","gatherpress"),scope:["inserter","transform"],example:{attributes:{...F},innerBlocks:[{name:"core/post-template",attributes:{},innerBlocks:[{name:"core/post-title"}]}]}}),(0,t.registerBlockVariation)("core/query",{...M,name:"gatherpress-event-query-map-date",title:(0,r.__)("Map & Event-Date","gatherpress"),description:(0,r.__)("Create gatherpress queries with Map & Date","gatherpress"),innerBlocks:[["core/post-template",{metadata:{name:(0,r.__)("Events Template","gatherpress")}},[]],T,S]}),(0,t.registerBlockVariation)("core/query",{...M,name:"gatherpress-event-query-date-title",title:(0,r.__)("Event-Date, Title & Venue details","gatherpress"),description:(0,r.__)("Create gatherpress queries with Event-Date & Title","gatherpress"),innerBlocks:[["core/post-template",{metadata:{name:(0,r.__)("Events Template","gatherpress")}},[{name:"core/post-title"}]],T,S]}),(0,t.registerBlockVariation)("core/query",{...M,name:"gatherpress-event-query-date-address",title:(0,r.__)("Event-Date & Venue Details","gatherpress"),description:(0,r.__)("Create gatherpress queries with Event-Date & Venue Details","gatherpress"),innerBlocks:[["core/post-template",{metadata:{name:(0,r.__)("Events Template","gatherpress")}},[]],T,S]})})();